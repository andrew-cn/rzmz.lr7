# Лабораторна робота 6. Збереження даних у БД в мобільному застосунку «Облік персоналу»

**Студент:** Андрій Федоров  
**Проєкт:** Lab3AndroidPersonnel (Jetpack Compose + Room)

---

## 1. Мета роботи

Розширити мобільний застосунок з лабораторної роботи 4, додавши збереження
даних у локальній базі даних за допомогою бібліотеки Room. Навчитися:
- описувати сутності (Entity) та DAO;
- створювати клас бази даних Room;
- реалізовувати репозиторій, що працює з БД;
- виконувати додавання, видалення та очищення даних з UI з використанням ViewModel.

---

## 2. Опис проєкту

Застосунок «Облік персоналу» дозволяє:
- обирати тип працівника: робітник, службовець, інженер;
- вводити ПІБ, вік, дату прийняття на роботу;
- заповнювати специфічні поля (зміна і години, посада і зарплата, спеціалізація і кількість проєктів);
- додавати записи до загального списку;
- видаляти окремі записи та очищувати список.

Початково список зберігався тільки в оперативній пам'яті (in-memory).  
У ЛР6 додано збереження у Room-БД.

---

## 3. Структура бази даних

### 3.1. Таблиця `personnel`

```text
+-----------------+---------------------------+
| Поле            | Тип                       |
+-----------------+---------------------------+
| id              | INTEGER (PK, autoinc)     |
| type            | PersonaType (enum)        |
| name            | TEXT                      |
| age             | INTEGER                   |
| hireDate        | TEXT (nullable)           |
| shift           | TEXT (nullable)           |
| hoursWorked     | INTEGER (nullable)        |
| position        | TEXT (nullable)           |
| salary          | REAL (nullable)           |
| specialization  | TEXT (nullable)           |
| projectsCount   | INTEGER (nullable)        |
+-----------------+---------------------------+
```

Таблиця зберігає всі три типи працівників. Непотрібні для конкретного типу
поля залишаються `NULL`.

---

## 4. Архітектура застосунку

```text
[UI (Jetpack Compose екрани)]
                |
                v
        [PersonnelViewModel]
                |
                v
       [PersonnelRepository]
                |
                v
            [PersonnelDao]
                |
                v
        [AppDatabase (Room)]
```

ViewModel виконує валідацію введених даних, створює об’єкти `Persona`
та через репозиторій викликає `dao.insert/delete/clear`. Список працівників
отримується з БД і передається у UI.

---

## 5. Виконані операції

- Підключено бібліотеку Room через Gradle (`kotlin-kapt`, `room-runtime`, `room-ktx`, `room-compiler`).
- Створено сутність `PersonnelEntity` з полями для всіх типів працівників.
- Реалізовано `PersonnelDao` з методами `getAll()`, `insert()`, `delete()`, `clear()`.
- Створено клас бази даних `AppDatabase`.
- Переписано `PersonnelRepository` для роботи з Room замість in-memory списку.
- Оновлено `PersonnelViewModel` для виклику репозиторію з використанням `viewModelScope`.
- Додано клас `PersonnelApplication` та фабрику `PersonnelViewModelFactory` для
  передачі репозиторію в ViewModel.
- База даних може бути заповнена не менше ніж 10 записами кожного типу працівників
  через відповідні форми введення в інтерфейсі.

---

## 6. Висновки

У результаті виконання лабораторної роботи було розширено існуючий мобільний
застосунок, додавши повноцінне збереження даних у локальній БД Room.
Застосунок тепер підтримує зберігання, відновлення після перезапуску, а також
видалення та очищення записів. Робота дозволила закріпити навички
проектування структури БД, налаштування Room та інтеграції БД з архітектурою
ViewModel + Repository у Jetpack Compose-застосунку.
